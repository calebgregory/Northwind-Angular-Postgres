'use strict';

angular.module('bundle', ['ui.router', 'ui.bootstrap', 'xeditable']).constant('BUN_URL', 'https://bundlecapstone.firebaseio.com/').config(function ($stateProvider, $urlRouterProvider) {
	$urlRouterProvider.when('', '/');
	$urlRouterProvider.otherwise('/');

	$stateProvider.state('home', {
		url: '/',
		templateUrl: 'assets/landing.html'
	}).state('bundleDash', {
		abstract: true,
		templateUrl: 'assets/bundledash.html'
	}).state('bundleDash.data', {
		url: '', //- need to add auth token to the beginning
		views: {
			'bundleRepeat': {
				templateUrl: 'assets/bundlerepeater.html',
				controller: 'bundleDash',
				controllerAs: 'bundleDash'
			},
			'newBundle': {
				templateUrl: 'assets/newbundle.html',
				controller: 'bundleDash',
				controllerAs: 'bundleDash'
			}
		}
	}).state('sectionDash', {
		abstract: true,
		templateUrl: 'assets/sectiondash.html'
	}).state('sectionDash.data', {
		url: '/bundle/{bKey}',
		views: {
			'sectionRepeat': {
				url: '', //- because bundles are not unique to userIDs you'd just store the bundles and search firebase via section IDs (even the ones you edit, those will just store to a new bundleID)
				templateUrl: 'assets/sectionrepeater.html',
				controller: 'newSection',
				controllerAs: 'newSection'
			},
			'newSection': {
				url: '',
				templateUrl: 'assets/newsection.html',
				controller: 'newSection',
				controllerAs: 'newSection'
			}

		}
	});
}).factory('Fire', function (BUN_URL) {
	return {
		newBun: function newBun(data) {
			var fb = new Firebase(BUN_URL);
			var ref = fb.child('bundle').push({
				bun_title: data
			});
			this.bKey = ref.key();
		},

		newSec: function newSec(location, data) {
			var fb = new Firebase(BUN_URL + location);
			var ref = fb.child('content').push({
				section_title: data
			});
			this.sKey = ref.key();
		},

		bunName: function bunName(location, cb) {
			var fb = new Firebase(BUN_URL + location);
			fb.limitToFirst(1).once('value', cb);
		},

		bunDash: function bunDash(cb) {
			var fb = new Firebase(BUN_URL + 'bundle');
			fb.once('value', cb);
		},

		secName: function secName(location, cb) {
			var fb = new Firebase(BUN_URL + location + '/content');
			fb.orderByChild('section_title').on('value', cb);
		},

		newCont: function newCont(location, sectionId, dataURL, dataTitle) {
			var fb = new Firebase(BUN_URL + location + '/content/' + sectionId);
			var ref = fb.child('context').push({
				content_title: dataURL,
				content_URL: dataTitle
			});
			this.buid = ref.key();
		},

		updateBunName: function updateBunName(id, newName) {
			var fb = new Firebase(BUN_URL + '/bundle/' + id);
			fb.update({
				bun_title: newName
			});
		},

		updateSecName: function updateSecName(location, id, newName) {
			var fb = new Firebase(BUN_URL + location + '/content/' + id);
			fb.update({
				section_title: newName
			});
		}

	};
});
//# sourceMappingURL=data:application/json;base64,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QUFDLENBQUM7R0FDTjs7QUFFRCxlQUFhLEVBQUMsdUJBQUMsUUFBUSxFQUFFLEVBQUUsRUFBRSxPQUFPLEVBQUU7QUFDcEMsT0FBSSxFQUFFLEdBQUcsSUFBSSxRQUFRLENBQUMsT0FBTyxHQUFHLFFBQVEsR0FBRyxXQUFXLEdBQUcsRUFBRSxDQUFDLENBQUE7QUFDMUQsS0FBRSxDQUNELE1BQU0sQ0FBQztBQUNOLGlCQUFhLEVBQUUsT0FBTztJQUN2QixDQUFDLENBQUE7R0FDTDs7RUFFRCxDQUFBO0NBQ0wsQ0FBQyxDQUFDIiwiZmlsZSI6InNyYy9qcy9tYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhclxuXHQubW9kdWxlKCdidW5kbGUnLCBbJ3VpLnJvdXRlcicsICd1aS5ib290c3RyYXAnLCAneGVkaXRhYmxlJ10pXG5cdFxuXHQuY29uc3RhbnQoJ0JVTl9VUkwnLCAnaHR0cHM6Ly9idW5kbGVjYXBzdG9uZS5maXJlYmFzZWlvLmNvbS8nKVxuXG5cdC5jb25maWcoZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcblx0JHVybFJvdXRlclByb3ZpZGVyLndoZW4oJycsJy8nKTtcbiAgICAkdXJsUm91dGVyUHJvdmlkZXIub3RoZXJ3aXNlKCcvJyk7XG5cbiAgICAkc3RhdGVQcm92aWRlclxuXG4gICAgICAgIC5zdGF0ZSgnaG9tZScsIHtcbiAgICAgICAgICB1cmw6ICcvJyxcbiAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2Fzc2V0cy9sYW5kaW5nLmh0bWwnXG4gICAgICAgIH0pXG5cbiAgICAgICAgLnN0YXRlKCdidW5kbGVEYXNoJywge1xuICAgICAgICBcdGFic3RyYWN0OiB0cnVlLCBcbiAgICAgICAgICBcdHRlbXBsYXRlVXJsOiAnYXNzZXRzL2J1bmRsZWRhc2guaHRtbCdcdCAgICAgICAgICBcdFxuICAgICAgXHR9KVxuXG4gICAgICAgIC5zdGF0ZSgnYnVuZGxlRGFzaC5kYXRhJywge1xuICAgICAgICBcdHVybDogJycsIC8vLSBuZWVkIHRvIGFkZCBhdXRoIHRva2VuIHRvIHRoZSBiZWdpbm5pbmcgXG5cdFx0XHQgICAgdmlld3M6IHtcblx0XHQgICAgICAgICAgICAnYnVuZGxlUmVwZWF0Jzoge1xuXHRcdCAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwiYXNzZXRzL2J1bmRsZXJlcGVhdGVyLmh0bWxcIiwgXG5cdFx0ICAgICAgICAgICAgICBjb250cm9sbGVyOiBcImJ1bmRsZURhc2hcIixcblx0XHQgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogXCJidW5kbGVEYXNoXCJcblx0XHQgICAgICAgICAgICB9LFxuXHRcdCAgICAgICAgICAgICAnbmV3QnVuZGxlJzoge1xuXHRcdCAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6IFwiYXNzZXRzL25ld2J1bmRsZS5odG1sXCIsIFxuXHRcdCAgICAgICAgICAgICAgY29udHJvbGxlcjogXCJidW5kbGVEYXNoXCIsXG5cdFx0ICAgICAgICAgICAgICBjb250cm9sbGVyQXM6IFwiYnVuZGxlRGFzaFwiXG5cdFx0ICAgICAgICAgICAgfVxuXHRcdCAgICAgICAgfVxuICAgICAgXHR9KVxuXG4gICAgICBcdC5zdGF0ZSgnc2VjdGlvbkRhc2gnLCB7XG4gICAgICAgIFx0YWJzdHJhY3Q6IHRydWUsIFxuICAgICAgICAgIFx0dGVtcGxhdGVVcmw6ICdhc3NldHMvc2VjdGlvbmRhc2guaHRtbCdcdCAgICAgICAgICBcdFxuICAgICAgXHR9KVxuXG4gICAgICAgIC5zdGF0ZSgnc2VjdGlvbkRhc2guZGF0YScsIHtcbiAgICAgICAgXHR1cmw6ICcvYnVuZGxlL3tiS2V5fScsXG5cdCAgICAgICAgICB2aWV3czoge1xuXHQgICAgICAgICAgICAnc2VjdGlvblJlcGVhdCc6IHtcblx0ICAgICAgICAgICAgICB1cmw6ICcnLCAvLy0gYmVjYXVzZSBidW5kbGVzIGFyZSBub3QgdW5pcXVlIHRvIHVzZXJJRHMgeW91J2QganVzdCBzdG9yZSB0aGUgYnVuZGxlcyBhbmQgc2VhcmNoIGZpcmViYXNlIHZpYSBzZWN0aW9uIElEcyAoZXZlbiB0aGUgb25lcyB5b3UgZWRpdCwgdGhvc2Ugd2lsbCBqdXN0IHN0b3JlIHRvIGEgbmV3IGJ1bmRsZUlEKVxuXHQgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBcImFzc2V0cy9zZWN0aW9ucmVwZWF0ZXIuaHRtbFwiLFxuXHQgICAgICAgICAgICAgIGNvbnRyb2xsZXI6IFwibmV3U2VjdGlvblwiLFxuXHQgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogXCJuZXdTZWN0aW9uXCJcblx0ICAgICAgICAgICAgfSxcblx0ICAgICAgICAgICBcdCduZXdTZWN0aW9uJzoge1xuXHQgICAgICAgICAgICAgIHVybDogJycsIFxuXHQgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiBcImFzc2V0cy9uZXdzZWN0aW9uLmh0bWxcIixcblx0ICAgICAgICAgICAgICBjb250cm9sbGVyOiBcIm5ld1NlY3Rpb25cIixcblx0ICAgICAgICAgICAgICBjb250cm9sbGVyQXM6IFwibmV3U2VjdGlvblwiXG5cdCAgICAgICAgICAgIH0sXG5cblx0ICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICBcdH0pXG5cbiAgXHQuZmFjdG9yeSgnRmlyZScsIGZ1bmN0aW9uIChCVU5fVVJMKSB7XG4gIFx0XHRyZXR1cm4ge1xuICBcdFx0XHRuZXdCdW4gKGRhdGEpIHtcblx0ICBcdFx0XHRcdHZhciBmYiA9IG5ldyBGaXJlYmFzZShCVU5fVVJMKTtcblx0ICBcdFx0XHRcdHZhciByZWYgPSBmYlxuXHQgIFx0XHRcdFx0LmNoaWxkKCdidW5kbGUnKVxuXHQgIFx0XHRcdFx0LnB1c2goe1xuXHQgIFx0XHRcdFx0XHRidW5fdGl0bGU6IGRhdGFcblx0ICBcdFx0XHRcdH0pO1xuXHQgIFx0XHRcdFx0dGhpcy5iS2V5ID0gcmVmLmtleSgpXG4gIFx0XHRcdH0sXG5cbiAgXHRcdFx0bmV3U2VjIChsb2NhdGlvbiwgZGF0YSkge1xuICBcdFx0XHRcdHZhciBmYiA9IG5ldyBGaXJlYmFzZShCVU5fVVJMICsgbG9jYXRpb24pO1xuXHRcdFx0XHRcdHZhciByZWYgPSBmYlxuXHRcdFx0XHRcdC5jaGlsZCgnY29udGVudCcpXG5cdFx0XHRcdFx0LnB1c2goe1xuXHRcdFx0XHRcdFx0c2VjdGlvbl90aXRsZTogZGF0YVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdHRoaXMuc0tleSA9IHJlZi5rZXkoKVxuICBcdFx0XHR9LFxuXG4gIFx0XHRcdGJ1bk5hbWUobG9jYXRpb24sIGNiKSB7XG4gIFx0XHRcdFx0dmFyIGZiID0gbmV3IEZpcmViYXNlKEJVTl9VUkwgKyBsb2NhdGlvbilcbiAgXHRcdFx0XHRmYlxuICAgICAgICAgIFx0XHRcdC5saW1pdFRvRmlyc3QoMSlcbiAgICAgICAgICBcdFx0XHQub25jZShcInZhbHVlXCIsIGNiKSBcbiAgXHRcdFx0fSxcblxuXHQgICAgICAgIGJ1bkRhc2goY2Ipe1xuXHQgICAgICAgICAgdmFyIGZiID0gbmV3IEZpcmViYXNlKEJVTl9VUkwgKyAnYnVuZGxlJylcblx0ICAgICAgICAgIGZiXG5cdCAgICAgICAgICBcdFx0Lm9uY2UoXCJ2YWx1ZVwiLCBjYikgXG5cdCAgICAgICAgfSxcblxuICBcdFx0XHRzZWNOYW1lKGxvY2F0aW9uLCBjYikge1xuICBcdFx0XHRcdHZhciBmYiA9IG5ldyBGaXJlYmFzZShCVU5fVVJMICsgbG9jYXRpb24gKyAnL2NvbnRlbnQnKVxuICBcdFx0XHRcdFx0ZmJcbiAgXHRcdFx0XHRcdC5vcmRlckJ5Q2hpbGQoJ3NlY3Rpb25fdGl0bGUnKVxuICBcdFx0XHRcdFx0Lm9uKFwidmFsdWVcIiwgY2IpIFxuICBcdFx0XHR9LFxuXG4gIFx0XHRcdG5ld0NvbnQgKGxvY2F0aW9uLCBzZWN0aW9uSWQsIGRhdGFVUkwsIGRhdGFUaXRsZSkge1xuICBcdFx0XHRcdHZhciBmYiA9IG5ldyBGaXJlYmFzZShCVU5fVVJMICsgbG9jYXRpb24gKyAnL2NvbnRlbnQvJyArIHNlY3Rpb25JZCk7XG5cdFx0XHRcdCAgdmFyIHJlZiA9IGZiXG5cdFx0XHRcdFx0LmNoaWxkKCdjb250ZXh0Jylcblx0XHRcdFx0XHQucHVzaCh7XG5cdFx0XHRcdFx0XHRjb250ZW50X3RpdGxlOiBkYXRhVVJMLFxuXHRcdFx0XHRcdFx0Y29udGVudF9VUkw6IGRhdGFUaXRsZVxuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdHRoaXMuYnVpZCA9IHJlZi5rZXkoKVxuICBcdFx0XHR9LFxuXG5cdCAgICAgICAgdXBkYXRlQnVuTmFtZSAoaWQsIG5ld05hbWUpIHtcblx0ICAgICAgICAgIHZhciBmYiA9IG5ldyBGaXJlYmFzZShCVU5fVVJMICsgJy9idW5kbGUvJyArIGlkKVxuXHQgICAgICAgICAgICBmYlxuXHQgICAgICAgICAgICAudXBkYXRlKHtcblx0ICAgICAgICAgICAgICBidW5fdGl0bGU6IG5ld05hbWVcblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgfSxcblxuXHQgICAgICAgIHVwZGF0ZVNlY05hbWUgKGxvY2F0aW9uLCBpZCwgbmV3TmFtZSkge1xuXHQgICAgICAgICAgdmFyIGZiID0gbmV3IEZpcmViYXNlKEJVTl9VUkwgKyBsb2NhdGlvbiArICcvY29udGVudC8nICsgaWQpXG5cdCAgICAgICAgICAgIGZiXG5cdCAgICAgICAgICAgIC51cGRhdGUoe1xuXHQgICAgICAgICAgICAgIHNlY3Rpb25fdGl0bGU6IG5ld05hbWVcblx0ICAgICAgICAgICAgfSlcblx0ICAgICAgICB9XG5cbiAgICAgICAgfVxuICBcdH0pOyJdfQ==
