'use strict';

angular.module('capstone').controller('bDashController', function ($scope, Bundles, $modal, Add, $rootScope) {

	(function () {
		var getAll = new Bundles.getAll();
		$scope.bundles = getAll.query();
	})();

	$scope['delete'] = function (id) {
		var deleteSelection = new Bundles.deleteOne();
		deleteSelection['delete']({ id: id }, function () {
			console.log('Deleted: ' + id);
			var getAll = new Bundles.getAll();
			$scope.bundles = getAll.query();
		});
	};
}).controller('addFormController', function ($scope, Add) {
	$scope.activeTab = 'Story';

	$scope.bundleSubmit = function () {
		Add.addBundle({
			title: $scope.title,
			url: $scope.url,
			tags: $scope.tags
			// userId: $rootScope.currentUser._id *** ADD WHEN CURRENTUSER IS VALIDATED
		}).then(function () {
			$scope.addBundleForm = null;
			$scope.title = null;
			$scope.url = null;
			$scope.tags = null;
		});
	};

	$scope.storySubmit = function () {
		Add.addStory({
			title: $scope.storyTitle,
			description: $scope.storyDescription,
			tags: $scope.tags
			// userId: $rootScope.currentUser ADD USER ID WHEN LINK IS READY
		}).then(function () {
			$scope.addStoryForm = null;
			$scope.storyTitle = null;
			$scope.storyTags = null;
			$scope.storyDescription = null;
		});
	};
}).controller('detailsCtrl', function ($scope, Authorize, $state) {
	$scope.logout = function () {
		Authorize.logout().then(function () {
			$state.go('start.dash');
		});
	};
});

// CHANGE TO PUBLIC DASHBOARD
// $scope.openModal = function() {
// 		var modalInstance = $modal.open({
// 				templateUrl: 'assets/addModal.html',
// 				controller: 'modalInstance'
// 			});

// 		modalInstance.result.then(function (information) {
// 			Add.addBundle({
// 				title: information.title,
// 				url: information.url,
// 				userId: $rootScope.currentUser._id
// 			});
// 		})
// 	}

// .controller('modalInstance', function ($scope, $modal, Add, $modalInstance) {

// $scope.information = {
// 	title: $scope.title,
// 	url: $scope.url
// }

// $scope.submit = function () {
// 	$modalInstance.close($scope.information)
// }

// $scope.cancel = function () {
// 	$modalInstance.dismiss('cancel');
// };

// })
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9qcy9iRGFzaC5jb250cm9sbGVyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7O0FBQUEsT0FBTyxDQUFDLE1BQU0sQ0FBQyxVQUFVLENBQUMsQ0FFekIsVUFBVSxDQUFDLGlCQUFpQixFQUFFLFVBQVUsTUFBTSxFQUFFLE9BQU8sRUFBRSxNQUFNLEVBQUUsR0FBRyxFQUFFLFVBQVUsRUFBRTs7QUFFbEYsRUFBQyxZQUFXO0FBQ1gsTUFBSSxNQUFNLEdBQUcsSUFBSSxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUE7QUFDakMsUUFBTSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUE7RUFDL0IsQ0FBQSxFQUFHLENBQUM7O0FBRUwsT0FBTSxVQUFPLEdBQUcsVUFBVSxFQUFFLEVBQUU7QUFDN0IsTUFBSSxlQUFlLEdBQUcsSUFBSSxPQUFPLENBQUMsU0FBUyxFQUFFLENBQUE7QUFDN0MsaUJBQWUsVUFBTyxDQUFDLEVBQUMsRUFBRSxFQUFFLEVBQUUsRUFBQyxFQUFFLFlBQVU7QUFDMUMsVUFBTyxDQUFDLEdBQUcsQ0FBQyxXQUFXLEdBQUcsRUFBRSxDQUFDLENBQUE7QUFDN0IsT0FBSSxNQUFNLEdBQUcsSUFBSSxPQUFPLENBQUMsTUFBTSxFQUFFLENBQUE7QUFDakMsU0FBTSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUMsS0FBSyxFQUFFLENBQUE7R0FDL0IsQ0FBQyxDQUFBO0VBQ0YsQ0FBQTtDQUVELENBQUMsQ0FFRCxVQUFVLENBQUMsbUJBQW1CLEVBQUUsVUFBVSxNQUFNLEVBQUUsR0FBRyxFQUFFO0FBQ3ZELE9BQU0sQ0FBQyxTQUFTLEdBQUcsT0FBTyxDQUFBOztBQUUxQixPQUFNLENBQUMsWUFBWSxHQUFHLFlBQVc7QUFDaEMsS0FBRyxDQUFDLFNBQVMsQ0FBQztBQUNaLFFBQUssRUFBRSxNQUFNLENBQUMsS0FBSztBQUNuQixNQUFHLEVBQUUsTUFBTSxDQUFDLEdBQUc7QUFDZixPQUFJLEVBQUUsTUFBTSxDQUFDLElBQUk7O0FBQUEsR0FFakIsQ0FBQyxDQUFDLElBQUksQ0FBQyxZQUFXO0FBQ2xCLFNBQU0sQ0FBQyxhQUFhLEdBQUcsSUFBSSxDQUFDO0FBQzVCLFNBQU0sQ0FBQyxLQUFLLEdBQUcsSUFBSSxDQUFDO0FBQ3BCLFNBQU0sQ0FBQyxHQUFHLEdBQUcsSUFBSSxDQUFDO0FBQ2xCLFNBQU0sQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDO0dBQ25CLENBQUMsQ0FBQTtFQUNILENBQUE7O0FBRUQsT0FBTSxDQUFDLFdBQVcsR0FBRyxZQUFZO0FBQ2hDLEtBQUcsQ0FBQyxRQUFRLENBQUM7QUFDWixRQUFLLEVBQUUsTUFBTSxDQUFDLFVBQVU7QUFDeEIsY0FBVyxFQUFFLE1BQU0sQ0FBQyxnQkFBZ0I7QUFDcEMsT0FBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJOztBQUFBLEdBRWpCLENBQUMsQ0FBQyxJQUFJLENBQUMsWUFBVztBQUNqQixTQUFNLENBQUMsWUFBWSxHQUFHLElBQUksQ0FBQTtBQUMxQixTQUFNLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQTtBQUN4QixTQUFNLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQTtBQUN2QixTQUFNLENBQUMsZ0JBQWdCLEdBQUcsSUFBSSxDQUFBO0dBQzlCLENBQUMsQ0FBQTtFQUNILENBQUE7Q0FFRCxDQUFDLENBRUQsVUFBVSxDQUFDLGFBQWEsRUFBRSxVQUFVLE1BQU0sRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFO0FBQy9ELE9BQU0sQ0FBQyxNQUFNLEdBQUcsWUFBVztBQUMxQixXQUFTLENBQUMsTUFBTSxFQUFFLENBQUMsSUFBSSxDQUFDLFlBQVc7QUFDbEMsU0FBTSxDQUFDLEVBQUUsQ0FBQyxZQUFZLENBQUMsQ0FBQTtHQUN2QixDQUFDLENBQUE7RUFDRixDQUFBO0NBRUQsQ0FBQyxDQUFBIiwiZmlsZSI6InNyYy9qcy9iRGFzaC5jb250cm9sbGVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2NhcHN0b25lJylcblxuLmNvbnRyb2xsZXIoJ2JEYXNoQ29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUsIEJ1bmRsZXMsICRtb2RhbCwgQWRkLCAkcm9vdFNjb3BlKSB7XG5cblx0KGZ1bmN0aW9uKCkge1xuXHRcdHZhciBnZXRBbGwgPSBuZXcgQnVuZGxlcy5nZXRBbGwoKVxuXHRcdCRzY29wZS5idW5kbGVzID0gZ2V0QWxsLnF1ZXJ5KClcblx0fSkoKTtcblxuXHQkc2NvcGUuZGVsZXRlID0gZnVuY3Rpb24gKGlkKSB7XG5cdFx0dmFyIGRlbGV0ZVNlbGVjdGlvbiA9IG5ldyBCdW5kbGVzLmRlbGV0ZU9uZSgpXG5cdFx0ZGVsZXRlU2VsZWN0aW9uLmRlbGV0ZSh7aWQ6IGlkfSwgZnVuY3Rpb24oKXtcblx0XHRcdGNvbnNvbGUubG9nKCdEZWxldGVkOiAnICsgaWQpXG5cdFx0XHR2YXIgZ2V0QWxsID0gbmV3IEJ1bmRsZXMuZ2V0QWxsKClcblx0XHRcdCRzY29wZS5idW5kbGVzID0gZ2V0QWxsLnF1ZXJ5KClcblx0XHR9KVxuXHR9XG5cbn0pXG5cbi5jb250cm9sbGVyKCdhZGRGb3JtQ29udHJvbGxlcicsIGZ1bmN0aW9uICgkc2NvcGUsIEFkZCkge1xuXHQkc2NvcGUuYWN0aXZlVGFiID0gJ1N0b3J5J1xuXG5cdCRzY29wZS5idW5kbGVTdWJtaXQgPSBmdW5jdGlvbigpIHtcblx0XHRBZGQuYWRkQnVuZGxlKHtcblx0XHRcdFx0dGl0bGU6ICRzY29wZS50aXRsZSxcblx0XHRcdFx0dXJsOiAkc2NvcGUudXJsLFxuXHRcdFx0XHR0YWdzOiAkc2NvcGUudGFnc1xuXHRcdFx0XHQvLyB1c2VySWQ6ICRyb290U2NvcGUuY3VycmVudFVzZXIuX2lkICoqKiBBREQgV0hFTiBDVVJSRU5UVVNFUiBJUyBWQUxJREFURURcblx0XHRcdH0pLnRoZW4oZnVuY3Rpb24oKSB7XG5cdFx0XHRcdCRzY29wZS5hZGRCdW5kbGVGb3JtID0gbnVsbDtcblx0XHRcdFx0JHNjb3BlLnRpdGxlID0gbnVsbDtcblx0XHRcdFx0JHNjb3BlLnVybCA9IG51bGw7XG5cdFx0XHRcdCRzY29wZS50YWdzID0gbnVsbDtcblx0XHRcdH0pXG5cdH1cblxuXHQkc2NvcGUuc3RvcnlTdWJtaXQgPSBmdW5jdGlvbiAoKSB7XG5cdFx0QWRkLmFkZFN0b3J5KHtcblx0XHRcdHRpdGxlOiAkc2NvcGUuc3RvcnlUaXRsZSxcblx0XHRcdGRlc2NyaXB0aW9uOiAkc2NvcGUuc3RvcnlEZXNjcmlwdGlvbixcblx0XHRcdHRhZ3M6ICRzY29wZS50YWdzXG5cdFx0XHQvLyB1c2VySWQ6ICRyb290U2NvcGUuY3VycmVudFVzZXIgQUREIFVTRVIgSUQgV0hFTiBMSU5LIElTIFJFQURZXG5cdFx0fSkudGhlbihmdW5jdGlvbigpIHtcblx0XHRcdFx0JHNjb3BlLmFkZFN0b3J5Rm9ybSA9IG51bGxcblx0XHRcdFx0JHNjb3BlLnN0b3J5VGl0bGUgPSBudWxsXG5cdFx0XHRcdCRzY29wZS5zdG9yeVRhZ3MgPSBudWxsXG5cdFx0XHRcdCRzY29wZS5zdG9yeURlc2NyaXB0aW9uID0gbnVsbFxuXHRcdFx0fSlcblx0fVxuXG59KVxuXG4uY29udHJvbGxlcignZGV0YWlsc0N0cmwnLCBmdW5jdGlvbiAoJHNjb3BlLCBBdXRob3JpemUsICRzdGF0ZSkge1xuXHQkc2NvcGUubG9nb3V0ID0gZnVuY3Rpb24oKSB7XG5cdFx0QXV0aG9yaXplLmxvZ291dCgpLnRoZW4oZnVuY3Rpb24oKSB7XG5cdFx0XHQkc3RhdGUuZ28oJ3N0YXJ0LmRhc2gnKSAvLyBDSEFOR0UgVE8gUFVCTElDIERBU0hCT0FSRFxuXHRcdH0pXG5cdH1cblxufSlcblxuXG5cbi8vICRzY29wZS5vcGVuTW9kYWwgPSBmdW5jdGlvbigpIHtcbi8vIFx0XHR2YXIgbW9kYWxJbnN0YW5jZSA9ICRtb2RhbC5vcGVuKHtcbi8vIFx0XHRcdFx0dGVtcGxhdGVVcmw6ICdhc3NldHMvYWRkTW9kYWwuaHRtbCcsXG4vLyBcdFx0XHRcdGNvbnRyb2xsZXI6ICdtb2RhbEluc3RhbmNlJ1xuLy8gXHRcdFx0fSk7XG5cbi8vIFx0XHRtb2RhbEluc3RhbmNlLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChpbmZvcm1hdGlvbikge1xuLy8gXHRcdFx0QWRkLmFkZEJ1bmRsZSh7XG4vLyBcdFx0XHRcdHRpdGxlOiBpbmZvcm1hdGlvbi50aXRsZSxcbi8vIFx0XHRcdFx0dXJsOiBpbmZvcm1hdGlvbi51cmwsXG4vLyBcdFx0XHRcdHVzZXJJZDogJHJvb3RTY29wZS5jdXJyZW50VXNlci5faWRcbi8vIFx0XHRcdH0pO1xuLy8gXHRcdH0pXG4vLyBcdH1cblxuLy8gLmNvbnRyb2xsZXIoJ21vZGFsSW5zdGFuY2UnLCBmdW5jdGlvbiAoJHNjb3BlLCAkbW9kYWwsIEFkZCwgJG1vZGFsSW5zdGFuY2UpIHtcblxuLy8gJHNjb3BlLmluZm9ybWF0aW9uID0ge1xuLy8gXHR0aXRsZTogJHNjb3BlLnRpdGxlLFxuLy8gXHR1cmw6ICRzY29wZS51cmxcbi8vIH1cblxuLy8gJHNjb3BlLnN1Ym1pdCA9IGZ1bmN0aW9uICgpIHtcbi8vIFx0JG1vZGFsSW5zdGFuY2UuY2xvc2UoJHNjb3BlLmluZm9ybWF0aW9uKVxuLy8gfVxuXG4vLyAkc2NvcGUuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuLy8gXHQkbW9kYWxJbnN0YW5jZS5kaXNtaXNzKCdjYW5jZWwnKTtcbi8vIH07XG5cblxuLy8gfSkiXX0=
