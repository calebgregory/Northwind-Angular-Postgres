'use strict';

angular.module('capstone').factory('Authorize', function ($http, $location, $rootScope, $cookieStore) {
	$rootScope.currentUser = $cookieStore.get('user');
	$cookieStore.remove('user');

	return {

		login: function login(user) {
			return $http.post('/api/login', user).success(function (data) {
				$rootScope.currentUser = data;
				$location.path('/');
				console.log('logged in');
			}).error(function () {
				console.log('no dice on the login');
			});
		},

		signup: function signup(user) {
			return $http.post('/api/signup', user).success(function (data) {
				$rootScope.currentUser = data;
				$location.path('/login');

				console.log('you made a new account');
			}).error(function (res) {
				console.log('something went wrong');
			});
		},

		logout: function logout() {
			return $http.post('/api/logout').success(function () {
				$rootScope.currentUser = null;
				$cookieStore.remove('user');
				console.log('logged out');
			});
		}

	};
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9qcy9tYWluLmZhY3RvcnkuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUV6QixPQUFPLENBQUMsV0FBVyxFQUFFLFVBQVMsS0FBSyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUFFO0FBQzFFLFdBQVUsQ0FBQyxXQUFXLEdBQUcsWUFBWSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQTtBQUNqRCxhQUFZLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFBOztBQUUzQixRQUFPOztBQUVOLE9BQUssRUFBRSxlQUFTLElBQUksRUFBRTtBQUNyQixVQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxDQUNuQyxPQUFPLENBQUMsVUFBUyxJQUFJLEVBQUU7QUFDdkIsY0FBVSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7QUFDOUIsYUFBUyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUNwQixXQUFPLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFBO0lBQ3hCLENBQUMsQ0FDRCxLQUFLLENBQUMsWUFBVztBQUNqQixXQUFPLENBQUMsR0FBRyxDQUFDLHNCQUFzQixDQUFDLENBQUE7SUFDbkMsQ0FBQyxDQUFDO0dBQ0o7O0FBRUQsUUFBTSxFQUFFLGdCQUFTLElBQUksRUFBRTtBQUN0QixVQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxDQUNwQyxPQUFPLENBQUMsVUFBUyxJQUFJLEVBQUU7QUFDdkIsY0FBVSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7QUFDOUIsYUFBUyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQzs7QUFFekIsV0FBTyxDQUFDLEdBQUcsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFBO0lBQ3JDLENBQUMsQ0FDRCxLQUFLLENBQUMsVUFBUyxHQUFHLEVBQUU7QUFDcEIsV0FBTyxDQUFDLEdBQUcsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFBO0lBQ25DLENBQUMsQ0FBQztHQUNKOztBQUVELFFBQU0sRUFBRSxrQkFBVztBQUNsQixVQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQzlCLE9BQU8sQ0FBQyxZQUFXO0FBQ25CLGNBQVUsQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFBO0FBQzdCLGdCQUFZLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQzVCLFdBQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUE7SUFDekIsQ0FBQyxDQUFDO0dBQ0o7O0VBR0QsQ0FBQTtDQUVELENBQUMsQ0FBQSIsImZpbGUiOiJzcmMvanMvbWFpbi5mYWN0b3J5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2NhcHN0b25lJylcblxuLmZhY3RvcnkoJ0F1dGhvcml6ZScsIGZ1bmN0aW9uKCRodHRwLCAkbG9jYXRpb24sICRyb290U2NvcGUsICRjb29raWVTdG9yZSkge1xuXHQkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gJGNvb2tpZVN0b3JlLmdldCgndXNlcicpXG5cdCRjb29raWVTdG9yZS5yZW1vdmUoJ3VzZXInKVxuXG5cdHJldHVybiB7XG5cblx0XHRsb2dpbjogZnVuY3Rpb24odXNlcikge1xuXHRcdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvbG9naW4nLCB1c2VyKVxuXHRcdFx0XHQuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG5cdFx0XHRcdFx0JHJvb3RTY29wZS5jdXJyZW50VXNlciA9IGRhdGE7XG5cdFx0XHRcdFx0JGxvY2F0aW9uLnBhdGgoJy8nKTtcblx0XHRcdFx0XHRjb25zb2xlLmxvZygnbG9nZ2VkIGluJylcblx0XHRcdFx0fSlcblx0XHRcdFx0LmVycm9yKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdubyBkaWNlIG9uIHRoZSBsb2dpbicpXG5cdFx0XHRcdH0pO1xuXHRcdH0sXG5cblx0XHRzaWdudXA6IGZ1bmN0aW9uKHVzZXIpIHtcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3NpZ251cCcsIHVzZXIpXG5cdFx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdFx0XHQkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gZGF0YTtcblx0XHRcdFx0XHQkbG9jYXRpb24ucGF0aCgnL2xvZ2luJyk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ3lvdSBtYWRlIGEgbmV3IGFjY291bnQnKVxuXHRcdFx0XHR9KVxuXHRcdFx0XHQuZXJyb3IoZnVuY3Rpb24ocmVzKSB7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ3NvbWV0aGluZyB3ZW50IHdyb25nJylcblx0XHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdGxvZ291dDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9sb2dvdXQnKVxuXHRcdFx0XHQuc3VjY2VzcyhmdW5jdGlvbigpIHtcblx0XHRcdFx0XHQkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gbnVsbFxuXHRcdFx0XHRcdCRjb29raWVTdG9yZS5yZW1vdmUoJ3VzZXInKTtcdFx0XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ2xvZ2dlZCBvdXQnKVxuXHRcdFx0XHR9KTtcblx0XHR9XG5cblxuXHR9XG5cbn0pIl19
