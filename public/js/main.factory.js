'use strict';

angular.module('capstone').factory('Authorize', function ($http, $location, $rootScope, $cookieStore) {
	$rootScope.currentUser = $cookieStore.get('user');
	$cookieStore.remove('user');
	return {

		login: function login(user) {
			return $http.post('/api/login', user).success(function (data) {
				$rootScope.currentUser = data;
				console.log('logged in');
				console.log(data);
			}).error(function () {
				console.log('no dice on the login');
			});
		},

		signup: function signup(user) {
			return $http.post('/api/signup', user).success(function (data) {
				$rootScope.currentUser = data;
				$location.path('/login');

				console.log('you made a new account');
			}).error(function (res) {
				console.log('something went wrong');
			});
		},

		logout: function logout() {
			return $http.post('/api/logout').success(function () {
				$rootScope.currentUser = null;
				$cookieStore.remove('user');
				console.log('logged out');
			});
		}
	};
}).factory('Add', function ($http, $location, $rootScope) {
	return {

		addBundle: function addBundle(data) {
			console.log(data);
			return $http.post('/api/bundle', data).success(function (data) {
				$rootScope.bundle = data; // CREATE A SERVICE TO SEND THIS TO
				console.log('scraped');
				console.log(data);
			}).error(function () {
				console.log('no dice on the scrape');
			});
		}
	};
}).factory('Bundles', function ($http, $location, $resource) {
	return $resource('/api/bundle/:id');
}).factory('BundlesD', function ($http, $location, $resource) {
	return $resource('/api/bundle/:id', {}, {
		'delete': { method: 'DELETE', params: { id: '@id' } }
	});
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9qcy9tYWluLmZhY3RvcnkuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUV6QixPQUFPLENBQUMsV0FBVyxFQUFFLFVBQVMsS0FBSyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUFFO0FBQzFFLFdBQVUsQ0FBQyxXQUFXLEdBQUcsWUFBWSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQTtBQUNqRCxhQUFZLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFBO0FBQzNCLFFBQU87O0FBRU4sT0FBSyxFQUFFLGVBQVMsSUFBSSxFQUFFO0FBQ3JCLFVBQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxZQUFZLEVBQUUsSUFBSSxDQUFDLENBQ25DLE9BQU8sQ0FBQyxVQUFTLElBQUksRUFBRTtBQUN2QixjQUFVLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztBQUM5QixXQUFPLENBQUMsR0FBRyxDQUFDLFdBQVcsQ0FBQyxDQUFBO0FBQ3hCLFdBQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUE7SUFDakIsQ0FBQyxDQUNELEtBQUssQ0FBQyxZQUFXO0FBQ2pCLFdBQU8sQ0FBQyxHQUFHLENBQUMsc0JBQXNCLENBQUMsQ0FBQTtJQUNuQyxDQUFDLENBQUM7R0FDSjs7QUFFRCxRQUFNLEVBQUUsZ0JBQVMsSUFBSSxFQUFFO0FBQ3RCLFVBQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUUsSUFBSSxDQUFDLENBQ3BDLE9BQU8sQ0FBQyxVQUFTLElBQUksRUFBRTtBQUN2QixjQUFVLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQztBQUM5QixhQUFTLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDOztBQUV6QixXQUFPLENBQUMsR0FBRyxDQUFDLHdCQUF3QixDQUFDLENBQUE7SUFDckMsQ0FBQyxDQUNELEtBQUssQ0FBQyxVQUFTLEdBQUcsRUFBRTtBQUNwQixXQUFPLENBQUMsR0FBRyxDQUFDLHNCQUFzQixDQUFDLENBQUE7SUFDbkMsQ0FBQyxDQUFDO0dBQ0o7O0FBRUQsUUFBTSxFQUFFLGtCQUFXO0FBQ2xCLFVBQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsQ0FDOUIsT0FBTyxDQUFDLFlBQVc7QUFDbkIsY0FBVSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUE7QUFDN0IsZ0JBQVksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDNUIsV0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsQ0FBQTtJQUN6QixDQUFDLENBQUM7R0FDSjtFQUNELENBQUE7Q0FDRCxDQUFDLENBRUQsT0FBTyxDQUFDLEtBQUssRUFBRSxVQUFTLEtBQUssRUFBRSxTQUFTLEVBQUUsVUFBVSxFQUFFO0FBQ3RELFFBQU87O0FBRU4sV0FBUyxFQUFFLG1CQUFTLElBQUksRUFBRTtBQUN6QixVQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFBO0FBQ2pCLFVBQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxhQUFhLEVBQUUsSUFBSSxDQUFDLENBQ3BDLE9BQU8sQ0FBQyxVQUFTLElBQUksRUFBRTtBQUN2QixjQUFVLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQztBQUN6QixXQUFPLENBQUMsR0FBRyxDQUFDLFNBQVMsQ0FBQyxDQUFBO0FBQ3RCLFdBQU8sQ0FBQyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUE7SUFDakIsQ0FBQyxDQUNELEtBQUssQ0FBQyxZQUFXO0FBQ2pCLFdBQU8sQ0FBQyxHQUFHLENBQUMsdUJBQXVCLENBQUMsQ0FBQTtJQUNwQyxDQUFDLENBQUM7R0FDSjtFQUNELENBQUE7Q0FDRCxDQUFDLENBRUQsT0FBTyxDQUFDLFNBQVMsRUFBRSxVQUFTLEtBQUssRUFBRSxTQUFTLEVBQUUsU0FBUyxFQUFFO0FBQ3hELFFBQU8sU0FBUyxDQUFDLGlCQUFpQixDQUFDLENBQUE7Q0FDcEMsQ0FBQyxDQUVELE9BQU8sQ0FBQyxVQUFVLEVBQUUsVUFBUyxLQUFLLEVBQUUsU0FBUyxFQUFFLFNBQVMsRUFBRTtBQUN6RCxRQUFPLFNBQVMsQ0FBQyxpQkFBaUIsRUFBRSxFQUFFLEVBQUU7QUFDeEMsWUFBUSxFQUFDLE1BQU0sRUFBRSxRQUFRLEVBQUUsTUFBTSxFQUFFLEVBQUMsRUFBRSxFQUFFLEtBQUssRUFBQyxFQUFDO0VBQzlDLENBQUMsQ0FBQTtDQUNILENBQUMsQ0FBQSIsImZpbGUiOiJzcmMvanMvbWFpbi5mYWN0b3J5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2NhcHN0b25lJylcblxuLmZhY3RvcnkoJ0F1dGhvcml6ZScsIGZ1bmN0aW9uKCRodHRwLCAkbG9jYXRpb24sICRyb290U2NvcGUsICRjb29raWVTdG9yZSkge1xuXHQkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gJGNvb2tpZVN0b3JlLmdldCgndXNlcicpXG5cdCRjb29raWVTdG9yZS5yZW1vdmUoJ3VzZXInKVxuXHRyZXR1cm4ge1xuXG5cdFx0bG9naW46IGZ1bmN0aW9uKHVzZXIpIHsgXG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9sb2dpbicsIHVzZXIpXG5cdFx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdFx0XHQkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gZGF0YTtcblx0XHRcdFx0XHRjb25zb2xlLmxvZygnbG9nZ2VkIGluJylcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhkYXRhKVxuXHRcdFx0XHR9KVxuXHRcdFx0XHQuZXJyb3IoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ25vIGRpY2Ugb24gdGhlIGxvZ2luJylcblx0XHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdHNpZ251cDogZnVuY3Rpb24odXNlcikge1xuXHRcdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvc2lnbnVwJywgdXNlcilcblx0XHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0XHRcdCRyb290U2NvcGUuY3VycmVudFVzZXIgPSBkYXRhO1xuXHRcdFx0XHRcdCRsb2NhdGlvbi5wYXRoKCcvbG9naW4nKTtcblx0XHRcdFx0XHRcblx0XHRcdFx0XHRjb25zb2xlLmxvZygneW91IG1hZGUgYSBuZXcgYWNjb3VudCcpXG5cdFx0XHRcdH0pXG5cdFx0XHRcdC5lcnJvcihmdW5jdGlvbihyZXMpIHtcblx0XHRcdFx0XHRjb25zb2xlLmxvZygnc29tZXRoaW5nIHdlbnQgd3JvbmcnKVxuXHRcdFx0XHR9KTtcblx0XHR9LFxuXG5cdFx0bG9nb3V0OiBmdW5jdGlvbigpIHtcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2xvZ291dCcpXG5cdFx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdCRyb290U2NvcGUuY3VycmVudFVzZXIgPSBudWxsXG5cdFx0XHRcdFx0JGNvb2tpZVN0b3JlLnJlbW92ZSgndXNlcicpO1x0XHRcblx0XHRcdFx0XHRjb25zb2xlLmxvZygnbG9nZ2VkIG91dCcpXG5cdFx0XHRcdH0pO1xuXHRcdH1cblx0fVxufSlcblxuLmZhY3RvcnkoJ0FkZCcsIGZ1bmN0aW9uKCRodHRwLCAkbG9jYXRpb24sICRyb290U2NvcGUpIHtcblx0cmV0dXJuIHtcblxuXHRcdGFkZEJ1bmRsZTogZnVuY3Rpb24oZGF0YSkgeyBcblx0XHRcdGNvbnNvbGUubG9nKGRhdGEpXG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9idW5kbGUnLCBkYXRhKVxuXHRcdFx0XHQuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG5cdFx0XHRcdFx0JHJvb3RTY29wZS5idW5kbGUgPSBkYXRhOyAvLyBDUkVBVEUgQSBTRVJWSUNFIFRPIFNFTkQgVEhJUyBUT1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdzY3JhcGVkJylcblx0XHRcdFx0XHRjb25zb2xlLmxvZyhkYXRhKVxuXHRcdFx0XHR9KVxuXHRcdFx0XHQuZXJyb3IoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ25vIGRpY2Ugb24gdGhlIHNjcmFwZScpXG5cdFx0XHRcdH0pO1xuXHRcdH1cblx0fVxufSlcblxuLmZhY3RvcnkoJ0J1bmRsZXMnLCBmdW5jdGlvbigkaHR0cCwgJGxvY2F0aW9uLCAkcmVzb3VyY2UpIHtcblx0XHRyZXR1cm4gJHJlc291cmNlKCcvYXBpL2J1bmRsZS86aWQnKVxufSlcblxuLmZhY3RvcnkoJ0J1bmRsZXNEJywgZnVuY3Rpb24oJGh0dHAsICRsb2NhdGlvbiwgJHJlc291cmNlKSB7XG5cdFx0cmV0dXJuICRyZXNvdXJjZSgnL2FwaS9idW5kbGUvOmlkJywge30sIHtcblx0XHRkZWxldGU6IHttZXRob2Q6ICdERUxFVEUnLCBwYXJhbXM6IHtpZDogJ0BpZCd9fVxuXHRcdH0pXG59KSJdfQ==
