'use strict';

angular.module('capstone').factory('Authorize', function ($http, $location, $rootScope, $cookieStore) {
	$rootScope.currentUser = $cookieStore.get('user');
	$cookieStore.remove('user');

	return {

		login: function login(user) {
			return $http.post('/api/login', JSON.stringify(user)).success(function (data) {
				$rootScope.currentUser = data;
				$location.path('/');
				console.log('logged in');
			}).error(function () {
				console.log('no dice on the login');
			});
		},

		signup: function signup(user) {
			return $http.post('/api/signup', user).success(function (data) {
				$rootScope.currentUser = data;
				$location.path('/login');

				console.log('you made a new account');
			}).error(function (res) {
				console.log('something went wrong');
			});
		},

		logout: function logout() {
			return $http.post('/api/logout').success(function () {
				$rootScope.currentUser = null;
				$cookieStore.remove('user');
				console.log('logged out');
			});
		}

	};
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9qcy9tYWluLmZhY3RvcnkuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUV6QixPQUFPLENBQUMsV0FBVyxFQUFFLFVBQVMsS0FBSyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUFFO0FBQzFFLFdBQVUsQ0FBQyxXQUFXLEdBQUcsWUFBWSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQTtBQUNqRCxhQUFZLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFBOztBQUUzQixRQUFPOztBQUVOLE9BQUssRUFBRSxlQUFTLElBQUksRUFBRTtBQUNyQixVQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FDbkQsT0FBTyxDQUFDLFVBQVMsSUFBSSxFQUFFO0FBQ3ZCLGNBQVUsQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO0FBQzlCLGFBQVMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDcEIsV0FBTyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQTtJQUN4QixDQUFDLENBQ0QsS0FBSyxDQUFDLFlBQVc7QUFDakIsV0FBTyxDQUFDLEdBQUcsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFBO0lBQ25DLENBQUMsQ0FBQztHQUNKOztBQUVELFFBQU0sRUFBRSxnQkFBUyxJQUFJLEVBQUU7QUFDdEIsVUFBTyxLQUFLLENBQUMsSUFBSSxDQUFDLGFBQWEsRUFBRSxJQUFJLENBQUMsQ0FDcEMsT0FBTyxDQUFDLFVBQVMsSUFBSSxFQUFFO0FBQ3ZCLGNBQVUsQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFDO0FBQzlCLGFBQVMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLENBQUM7O0FBRXpCLFdBQU8sQ0FBQyxHQUFHLENBQUMsd0JBQXdCLENBQUMsQ0FBQTtJQUNyQyxDQUFDLENBQ0QsS0FBSyxDQUFDLFVBQVMsR0FBRyxFQUFFO0FBQ3BCLFdBQU8sQ0FBQyxHQUFHLENBQUMsc0JBQXNCLENBQUMsQ0FBQTtJQUNuQyxDQUFDLENBQUM7R0FDSjs7QUFFRCxRQUFNLEVBQUUsa0JBQVc7QUFDbEIsVUFBTyxLQUFLLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxDQUM5QixPQUFPLENBQUMsWUFBVztBQUNuQixjQUFVLENBQUMsV0FBVyxHQUFHLElBQUksQ0FBQTtBQUM3QixnQkFBWSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsQ0FBQztBQUM1QixXQUFPLENBQUMsR0FBRyxDQUFDLFlBQVksQ0FBQyxDQUFBO0lBQ3pCLENBQUMsQ0FBQztHQUNKOztFQUdELENBQUE7Q0FFRCxDQUFDLENBQUEiLCJmaWxlIjoic3JjL2pzL21haW4uZmFjdG9yeS5qcyIsInNvdXJjZXNDb250ZW50IjpbImFuZ3VsYXIubW9kdWxlKCdjYXBzdG9uZScpXG5cbi5mYWN0b3J5KCdBdXRob3JpemUnLCBmdW5jdGlvbigkaHR0cCwgJGxvY2F0aW9uLCAkcm9vdFNjb3BlLCAkY29va2llU3RvcmUpIHtcblx0JHJvb3RTY29wZS5jdXJyZW50VXNlciA9ICRjb29raWVTdG9yZS5nZXQoJ3VzZXInKVxuXHQkY29va2llU3RvcmUucmVtb3ZlKCd1c2VyJylcblxuXHRyZXR1cm4ge1xuXG5cdFx0bG9naW46IGZ1bmN0aW9uKHVzZXIpIHsgXG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9sb2dpbicsIEpTT04uc3RyaW5naWZ5KHVzZXIpKVxuXHRcdFx0XHQuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG5cdFx0XHRcdFx0JHJvb3RTY29wZS5jdXJyZW50VXNlciA9IGRhdGE7XG5cdFx0XHRcdFx0JGxvY2F0aW9uLnBhdGgoJy8nKTtcblx0XHRcdFx0XHRjb25zb2xlLmxvZygnbG9nZ2VkIGluJylcblx0XHRcdFx0fSlcblx0XHRcdFx0LmVycm9yKGZ1bmN0aW9uKCkge1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdubyBkaWNlIG9uIHRoZSBsb2dpbicpXG5cdFx0XHRcdH0pO1xuXHRcdH0sXG5cblx0XHRzaWdudXA6IGZ1bmN0aW9uKHVzZXIpIHtcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL3NpZ251cCcsIHVzZXIpXG5cdFx0XHRcdC5zdWNjZXNzKGZ1bmN0aW9uKGRhdGEpIHtcblx0XHRcdFx0XHQkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gZGF0YTtcblx0XHRcdFx0XHQkbG9jYXRpb24ucGF0aCgnL2xvZ2luJyk7XG5cdFx0XHRcdFx0XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ3lvdSBtYWRlIGEgbmV3IGFjY291bnQnKVxuXHRcdFx0XHR9KVxuXHRcdFx0XHQuZXJyb3IoZnVuY3Rpb24ocmVzKSB7XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ3NvbWV0aGluZyB3ZW50IHdyb25nJylcblx0XHRcdFx0fSk7XG5cdFx0fSxcblxuXHRcdGxvZ291dDogZnVuY3Rpb24oKSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9sb2dvdXQnKVxuXHRcdFx0XHQuc3VjY2VzcyhmdW5jdGlvbigpIHtcblx0XHRcdFx0XHQkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gbnVsbFxuXHRcdFx0XHRcdCRjb29raWVTdG9yZS5yZW1vdmUoJ3VzZXInKTtcdFx0XG5cdFx0XHRcdFx0Y29uc29sZS5sb2coJ2xvZ2dlZCBvdXQnKVxuXHRcdFx0XHR9KTtcblx0XHR9XG5cblxuXHR9XG5cbn0pIl19
