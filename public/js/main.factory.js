'use strict';

angular.module('capstone').factory('Authorize', function ($http, $location, $rootScope, $cookieStore) {
	$rootScope.currentUser = $cookieStore.get('user');
	$cookieStore.remove('user');

	return {

		login: function login(user) {
			return $http.post('/api/login', user).success(function (data) {
				$rootScope.currentUser = data;
				console.log('logged in');
				console.log(data);
			}).error(function () {
				console.log('no dice on the login');
			});
		},

		signup: function signup(user) {
			return $http.post('/api/signup', user).success(function (data) {
				$rootScope.currentUser = data;
				$location.path('/login');

				console.log('you made a new account');
			}).error(function (res) {
				console.log('something went wrong');
			});
		},

		logout: function logout() {
			return $http.post('/api/logout').success(function () {
				$rootScope.currentUser = null;
				$cookieStore.remove('user');
				console.log('logged out');
			});
		}

	};
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNyYy9qcy9tYWluLmZhY3RvcnkuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7QUFBQSxPQUFPLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQyxDQUV6QixPQUFPLENBQUMsV0FBVyxFQUFFLFVBQVMsS0FBSyxFQUFFLFNBQVMsRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUFFO0FBQzFFLFdBQVUsQ0FBQyxXQUFXLEdBQUcsWUFBWSxDQUFDLEdBQUcsQ0FBQyxNQUFNLENBQUMsQ0FBQTtBQUNqRCxhQUFZLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFBOztBQUUzQixRQUFPOztBQUVOLE9BQUssRUFBRSxlQUFTLElBQUksRUFBRTtBQUNyQixVQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsWUFBWSxFQUFFLElBQUksQ0FBQyxDQUNuQyxPQUFPLENBQUMsVUFBUyxJQUFJLEVBQUU7QUFDdkIsY0FBVSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7QUFDOUIsV0FBTyxDQUFDLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQTtBQUN4QixXQUFPLENBQUMsR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFBO0lBQ2pCLENBQUMsQ0FDRCxLQUFLLENBQUMsWUFBVztBQUNqQixXQUFPLENBQUMsR0FBRyxDQUFDLHNCQUFzQixDQUFDLENBQUE7SUFDbkMsQ0FBQyxDQUFDO0dBQ0o7O0FBRUQsUUFBTSxFQUFFLGdCQUFTLElBQUksRUFBRTtBQUN0QixVQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFLElBQUksQ0FBQyxDQUNwQyxPQUFPLENBQUMsVUFBUyxJQUFJLEVBQUU7QUFDdkIsY0FBVSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7QUFDOUIsYUFBUyxDQUFDLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQzs7QUFFekIsV0FBTyxDQUFDLEdBQUcsQ0FBQyx3QkFBd0IsQ0FBQyxDQUFBO0lBQ3JDLENBQUMsQ0FDRCxLQUFLLENBQUMsVUFBUyxHQUFHLEVBQUU7QUFDcEIsV0FBTyxDQUFDLEdBQUcsQ0FBQyxzQkFBc0IsQ0FBQyxDQUFBO0lBQ25DLENBQUMsQ0FBQztHQUNKOztBQUVELFFBQU0sRUFBRSxrQkFBVztBQUNsQixVQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsYUFBYSxDQUFDLENBQzlCLE9BQU8sQ0FBQyxZQUFXO0FBQ25CLGNBQVUsQ0FBQyxXQUFXLEdBQUcsSUFBSSxDQUFBO0FBQzdCLGdCQUFZLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDO0FBQzVCLFdBQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUE7SUFDekIsQ0FBQyxDQUFDO0dBQ0o7O0VBR0QsQ0FBQTtDQUVELENBQUMsQ0FBQSIsImZpbGUiOiJzcmMvanMvbWFpbi5mYWN0b3J5LmpzIiwic291cmNlc0NvbnRlbnQiOlsiYW5ndWxhci5tb2R1bGUoJ2NhcHN0b25lJylcblxuLmZhY3RvcnkoJ0F1dGhvcml6ZScsIGZ1bmN0aW9uKCRodHRwLCAkbG9jYXRpb24sICRyb290U2NvcGUsICRjb29raWVTdG9yZSkge1xuXHQkcm9vdFNjb3BlLmN1cnJlbnRVc2VyID0gJGNvb2tpZVN0b3JlLmdldCgndXNlcicpXG5cdCRjb29raWVTdG9yZS5yZW1vdmUoJ3VzZXInKVxuXG5cdHJldHVybiB7XG5cblx0XHRsb2dpbjogZnVuY3Rpb24odXNlcikgeyBcblx0XHRcdHJldHVybiAkaHR0cC5wb3N0KCcvYXBpL2xvZ2luJywgdXNlcilcblx0XHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24oZGF0YSkge1xuXHRcdFx0XHRcdCRyb290U2NvcGUuY3VycmVudFVzZXIgPSBkYXRhO1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdsb2dnZWQgaW4nKVxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKGRhdGEpXG5cdFx0XHRcdH0pXG5cdFx0XHRcdC5lcnJvcihmdW5jdGlvbigpIHtcblx0XHRcdFx0XHRjb25zb2xlLmxvZygnbm8gZGljZSBvbiB0aGUgbG9naW4nKVxuXHRcdFx0XHR9KTtcblx0XHR9LFxuXG5cdFx0c2lnbnVwOiBmdW5jdGlvbih1c2VyKSB7XG5cdFx0XHRyZXR1cm4gJGh0dHAucG9zdCgnL2FwaS9zaWdudXAnLCB1c2VyKVxuXHRcdFx0XHQuc3VjY2VzcyhmdW5jdGlvbihkYXRhKSB7XG5cdFx0XHRcdFx0JHJvb3RTY29wZS5jdXJyZW50VXNlciA9IGRhdGE7XG5cdFx0XHRcdFx0JGxvY2F0aW9uLnBhdGgoJy9sb2dpbicpO1xuXHRcdFx0XHRcdFxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCd5b3UgbWFkZSBhIG5ldyBhY2NvdW50Jylcblx0XHRcdFx0fSlcblx0XHRcdFx0LmVycm9yKGZ1bmN0aW9uKHJlcykge1xuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdzb21ldGhpbmcgd2VudCB3cm9uZycpXG5cdFx0XHRcdH0pO1xuXHRcdH0sXG5cblx0XHRsb2dvdXQ6IGZ1bmN0aW9uKCkge1xuXHRcdFx0cmV0dXJuICRodHRwLnBvc3QoJy9hcGkvbG9nb3V0Jylcblx0XHRcdFx0LnN1Y2Nlc3MoZnVuY3Rpb24oKSB7XG5cdFx0XHRcdFx0JHJvb3RTY29wZS5jdXJyZW50VXNlciA9IG51bGxcblx0XHRcdFx0XHQkY29va2llU3RvcmUucmVtb3ZlKCd1c2VyJyk7XHRcdFxuXHRcdFx0XHRcdGNvbnNvbGUubG9nKCdsb2dnZWQgb3V0Jylcblx0XHRcdFx0fSk7XG5cdFx0fVxuXG5cblx0fVxuXG59KSJdfQ==
